{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1aa438e9a95b77be5e1d","webpack:///./src/index.js","webpack:///./src/components/browseButton/index.js","webpack:///./src/components/contentDropdown/index.js","webpack:///./src/components/primaryAnnoDropdown/index.js","webpack:///./src/components/referenceAnnoDropdown/index.js","webpack:///./src/components/annoListDropdown/index.js","webpack:///./src/components/downloadButton/index.js","webpack:///./src/components/annoRectButton/index.js","webpack:///./src/components/annoRelButton/index.js","webpack:///./src/components/annoSpanButton/index.js","webpack:///./src/components/labelInput/index.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5DA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAgBA;;AAEA;;;;;;;;;;AC9BA;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,SAAS;;AAET,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET,KAAK;;AAEL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,aAAa;AACjE;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,gDAAgD,UAAU;AAC1D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gDAAgD,UAAU;AAC1D;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;;;;;;;;AC9RA;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA,gB;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AC3EA;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;AACL;;;;;;;;;ACzDA;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;;AAEA,KAAK;;AAEL;;;;;;;;;ACrCA;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA,2CAA2C,OAAO;AAClD,0BAA0B,KAAK,MAAM,MAAM,QAAQ,aAAa;AAChE;AACA;AACA;;AAEA;AACA,SAAS;;AAET;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AChEA;AAAA;AACA;AACA;;AAEA;AACA,WAAW,2BAA2B;;AAEtC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;;AAEA;AACA,KAAK;;AAEL;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;ACzDA,gBAAuB,0BAA0B;;AAEjD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL,C;;;;;;;;;;;ACtBA,gBAAuB,sBAAsB;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,C;;;;;;;;;;;ACTA,gBAAuB,uBAAuB;;AAE9C;;AAEA;;AAEA;AACA,KAAK;AACL,C;;;;;;;;;;ACVA;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA,gBAAuB,6CAA6C;;AAEpE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA,iBAAwB,gEAAgE;AACxF;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,iCAAiC,OAAO;AACxC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,iEAAiE;AACjF;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,iDAAiD;AACjE,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB,6CAA6C;AAC7D,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,iCAAiC,EAAE;AACnC,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,8DAA8D,EAAE;AAChE;AACA;AACA;AACA,SAAS;;AAET;;AAEA,KAAK;;AAEL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;;AAEA;AACA,KAAK;AACL;;;AAGA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"annoUI\"] = factory();\n\telse\n\t\troot[\"annoUI\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1aa438e9a95b77be5e1d","\nimport * as browseButton from './components/browseButton';\nimport * as contentDropdown from './components/contentDropdown';\nimport * as primaryAnnoDropdown from './components/primaryAnnoDropdown';\nimport * as referenceAnnoDropdown from './components/referenceAnnoDropdown';\nimport * as annoListDropdown from './components/annoListDropdown';\nimport * as downloadButton from './components/downloadButton';\n\nimport * as annoRectButton from './components/annoRectButton';\nimport * as annoRelButton from './components/annoRelButton';\nimport * as annoSpanButton from './components/annoSpanButton';\n\nimport * as labelInput from './components/labelInput';\n\nexport {\n\n    browseButton,\n    contentDropdown,\n    primaryAnnoDropdown,\n    referenceAnnoDropdown,\n    annoListDropdown,\n    downloadButton,\n\n    annoRectButton,\n    annoRelButton,\n    annoSpanButton,\n\n    labelInput\n}\n\n// TODO 残：pdfanno.jsからのお引越し.\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.js\n// module id = 0\n// module chunks = 0","/**\n * UI parts - Browse button.\n */\n\n/**\n * Setup the color pickers.\n */\nexport function setupColorPicker() {\n\n    const colors = [\n        'rgb(255, 128, 0)', 'hsv 100 70 50', 'yellow', 'blanchedalmond',\n        'red', 'green', 'blue', 'violet'\n    ];\n\n    // Setup colorPickers.\n    $('.js-anno-palette').spectrum({\n        showPaletteOnly        : true,\n        showPalette            : true,\n        hideAfterPaletteSelect : true,\n        palette                : [\n            colors.slice(0, Math.floor(colors.length/2)),\n            colors.slice(Math.floor(colors.length/2), colors.length)\n        ]\n    });\n    // Set initial color.\n    $('.js-anno-palette').each((i, elm) => {\n        $(elm).spectrum('set', colors[ i % colors.length ]);\n    });\n\n    // Setup behavior.\n    $('.js-anno-palette').off('change').on('change', _displayCurrentReferenceAnnotations());\n}\n\n// TODO この辺は、pdfannoのせいでかなり複雑なので、なんとかしたいなー.\nlet _loadFiles;\nlet _clearAllAnnotations;\nlet _displayCurrentReferenceAnnotations;\nlet _displayCurrentPrimaryAnnotations;\nlet _getContentFiles;\nlet _getAnnoFiles;\nlet _closePDFViewer;\n\n/**\n * Setup the behavior of a Browse Button.\n */\nexport function setup({ \n        loadFiles,\n        clearAllAnnotations,\n        displayCurrentReferenceAnnotations,\n        displayCurrentPrimaryAnnotations,\n        getContentFiles,\n        getAnnoFiles,\n        closePDFViewer,\n    }) {\n\n    _loadFiles = loadFiles;\n    _clearAllAnnotations = clearAllAnnotations;\n    _displayCurrentReferenceAnnotations = displayCurrentReferenceAnnotations;\n    _displayCurrentPrimaryAnnotations = displayCurrentPrimaryAnnotations;\n    _getContentFiles = getContentFiles,\n    _getAnnoFiles = getAnnoFiles;\n    _closePDFViewer = closePDFViewer;\n\n    // Enable to select the same directory twice or more.\n    $('.js-file :file').on('click', ev => {\n        $('input[type=\"file\"]').val(null);\n    });\n\n    $('.js-file :file').on('change', ev => {\n\n        const files = ev.target.files;\n\n        let error = isValidDirectorySelect(files);\n        if (error) {\n            return alert(error);\n        }\n\n        loadFiles(files).then(() => {\n\n            // Get current visuals.\n            const current = getCurrentFileNames();\n\n            // Initialize PDF Viewer.\n            clearAllAnnotations();\n\n            // Setup PDF Dropdown.\n            setPDFDropdownList();\n\n            // Setup Anno Dropdown.\n            setAnnoDropdownList();\n\n            // Display a PDF and annotations.\n            restoreBeforeState(current);\n\n        });\n\n    });\n}\n\n/**\n * Check whether the directory the user specified is valid.\n */\nfunction isValidDirectorySelect(files) {\n\n    // Error, if no contents exits.\n    if (!files || files.length === 0) {\n        return 'Not files specified';\n    }\n\n    // Error, if the user select a file - not a directory.\n    let relativePath = files[0].webkitRelativePath;\n    if (!relativePath) {\n        return 'Please select a directory, NOT a file';\n    }\n\n    // OK.\n    return null;\n}\n\n/**\n * Restore the state before Browse button was clicked.\n */\nfunction restoreBeforeState(currentDisplay) {\n\n    let files;\n\n    let isPDFClosed = false;\n\n    // Restore the check state of a content.\n    files = _getContentFiles().filter(c => c.name === currentDisplay.pdfName);\n    if (files.length > 0) {\n        $('#dropdownPdf .js-text').text(files[0].name);\n        $('#dropdownPdf a').each((index, element) => {\n            let $elm = $(element);\n            if ($elm.find('.js-content-name').text() === currentDisplay.pdfName) {\n                $elm.find('.fa-check').removeClass('no-visible');\n            }\n        });\n\n    } else {\n\n        isPDFClosed = true;\n\n        _closePDFViewer();\n    }\n\n    // Restore the check state of a primaryAnno.\n    files = _getAnnoFiles().filter(c => c.name === currentDisplay.primaryAnnotationName);\n    if (files.length > 0 && isPDFClosed === false) {\n        $('#dropdownAnnoPrimary .js-text').text(currentDisplay.primaryAnnotationName);\n        $('#dropdownAnnoPrimary a').each((index, element) => {\n            let $elm = $(element);\n            if ($elm.find('.js-annoname').text() === currentDisplay.primaryAnnotationName) {\n                $elm.find('.fa-check').removeClass('no-visible');\n            }\n        });\n        setTimeout(() => {\n            _displayCurrentPrimaryAnnotations();\n        }, 100);\n    }\n\n    // Restore the check states of referenceAnnos.\n    let names = currentDisplay.referenceAnnotationNames;\n    let colors = currentDisplay.referenceAnnotationColors;\n    names = names.filter((name, i) => {\n        let found = false;\n        let annos = _getAnnoFiles().filter(c => c.name === name);\n        if (annos.length > 0) {\n            $('#dropdownAnnoReference a').each((index, element) => {\n                let $elm = $(element);\n                if ($elm.find('.js-annoname').text() === name) {\n                    $elm.find('.fa-check').removeClass('no-visible');\n                    $elm.find('.js-anno-palette').spectrum('set', colors[i]);\n                    found = true;\n                }\n            });\n        }\n        return found;\n    });\n\n    if (names.length > 0 && isPDFClosed === false) {\n        $('#dropdownAnnoReference .js-text').text(names.join(','));\n        setTimeout(() => {\n            _displayCurrentReferenceAnnotations();\n        }, 500);\n\n    }\n\n}\n\n/**\n * Get the file names which currently are displayed.\n */\nfunction getCurrentFileNames() {\n\n    let text;\n\n    // a PDF name.\n    text = $('#dropdownPdf .js-text').text();\n    let pdfName = (text !== 'PDF File' ? text : null);\n\n    // a Primary anno.\n    text = $('#dropdownAnnoPrimary .js-text').text();\n    let primaryAnnotationName = (text !== 'Anno File' ? text : null);\n\n    let referenceAnnotationNames = [];\n    let referenceAnnotationColors = [];\n    $('#dropdownAnnoReference a').each((index, element) => {\n        let $elm = $(element);\n        if ($elm.find('.fa-check').hasClass('no-visible') === false) {\n            let annoName = $elm.find('.js-annoname').text();\n            referenceAnnotationNames.push(annoName);\n            let color = $elm.find('.js-anno-palette').spectrum('get').toHexString();\n            referenceAnnotationColors.push(color);\n        }\n    });\n\n    return {\n        pdfName,\n        primaryAnnotationName,\n        referenceAnnotationNames,\n        referenceAnnotationColors\n    };\n}\n\n/**\n * Reset and setup the PDF dropdown.\n */\nfunction setPDFDropdownList() {\n\n    // Reset the state of the PDF dropdown.\n    $('#dropdownPdf .js-text').text('PDF File');\n    $('#dropdownPdf li').remove();\n\n    // Create and setup the dropdown menu.\n    const snipets = _getContentFiles().map(content => {\n        return `\n            <li>\n                <a href=\"#\">\n                    <i class=\"fa fa-check no-visible\"></i>&nbsp;\n                    <span class=\"js-content-name\">${content.name}</span>\n                </a>\n            </li>\n        `;\n    });\n    $('#dropdownPdf ul').append(snipets.join(''));\n}\n\n/**\n * Reset and setup the primary/reference annotation dropdown.\n */\nfunction setAnnoDropdownList() {\n\n    // Reset the UI of primary/reference anno dropdowns.\n    $('#dropdownAnnoPrimary ul').html('');\n    $('#dropdownAnnoReference ul').html('');\n    $('#dropdownAnnoPrimary .js-text').text('Anno File');\n    $('#dropdownAnnoReference .js-text').text('Reference Files');\n\n    // Setup anno / reference dropdown.\n    _getAnnoFiles().forEach(file => {\n\n        let snipet1 = `\n            <li>\n                <a href=\"#\">\n                    <i class=\"fa fa-check no-visible\" aria-hidden=\"true\"></i>\n                    <span class=\"js-annoname\">${file.name}</span>\n                </a>\n            </li>\n        `;\n        $('#dropdownAnnoPrimary ul').append(snipet1);\n\n        let snipet2 = `\n            <li>\n                <a href=\"#\">\n                    <i class=\"fa fa-check no-visible\" aria-hidden=\"true\"></i>\n                    <input type=\"text\" name=\"color\" class=\"js-anno-palette\" autocomplete=\"off\">\n                    <span class=\"js-annoname\">${file.name}</span>\n                </a>\n            </li>\n        `;\n        $('#dropdownAnnoReference ul').append(snipet2);\n    });\n\n    // Setup color pallets.\n    setupColorPicker();\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/browseButton/index.js\n// module id = 1\n// module chunks = 0","/**\n * UI parts - Content dropdown.\n */\n\n/**\n * Setup the dropdown of PDFs.\n */\nexport function setup({ \n        initialText,\n        overrideWarningMessage,\n        contentReloadHandler,\n    }) {\n\n    $('#dropdownPdf .js-text').text(initialText);\n\n    // TODO pdfという単語を削除したい..\n\n    $('#dropdownPdf').on('click', 'a', e => {\n\n        const $this = $(e.currentTarget);\n\n        // Get the name of PDF clicked.\n        const pdfName = $this.find('.js-content-name').text();\n\n        // Get the name of PDF currently displayed.\n        const currentPDFName = $('#dropdownPdf .js-text').text();\n\n        // No action, if the current PDF is selected.\n        if (currentPDFName === pdfName) {\n            console.log('Not reload. the contents are same.');\n            return;\n        }\n\n        // Confirm to override.\n        if (currentPDFName !== initialText) {\n            if (!window.confirm(overrideWarningMessage)) {\n                return;\n            }\n        }\n\n        // Update PDF's name displayed.\n        $('#dropdownPdf .js-text').text(pdfName);\n\n        // Update the dropdown selection.\n        $('#dropdownPdf .fa-check').addClass('no-visible');\n        $this.find('.fa-check').removeClass('no-visible');\n\n        // Reset annotations' dropdowns.\n        resetCheckPrimaryAnnoDropdown();\n        resetCheckReferenceAnnoDropdown();\n\n        // Close dropdown.\n        $('#dropdownPdf').click();\n\n        // Reload Content.\n        contentReloadHandler(pdfName);\n\n        return false;\n    });\n}\n\n/**\n * Reset the primary annotation dropdown selection.\n */\nfunction resetCheckPrimaryAnnoDropdown() {\n    $('#dropdownAnnoPrimary .js-text').text('Anno File');\n    $('#dropdownAnnoPrimary .fa-check').addClass('no-visible');\n}\n\n/**\n * Reset the reference annotation dropdown selection.\n */\nfunction resetCheckReferenceAnnoDropdown() {\n    $('#dropdownAnnoReference .js-text').text('Reference Files');\n    $('#dropdownAnnoReference .fa-check').addClass('no-visible');\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/contentDropdown/index.js\n// module id = 2\n// module chunks = 0","/**\n * UI parts - Primary anno dropdown.\n */\n\n/**\n * Setup a click action of the Primary Annotation Dropdown.\n */\nexport function setup({\n        clearPrimaryAnnotations,\n        displayPrimaryAnnotation\n    }) {\n\n    $('#dropdownAnnoPrimary').on('click', 'a', e => {\n\n        let $this = $(e.currentTarget);\n        let annoName = $this.find('.js-annoname').text();\n\n        let currentAnnoName = $('#dropdownAnnoPrimary .js-text').text();\n        if (currentAnnoName === annoName) {\n\n            let userAnswer = window.confirm('Are you sure to clear the current annotations?');\n            if (!userAnswer) {\n                return;\n            }\n\n            $('#dropdownAnnoPrimary .fa-check').addClass('no-visible');\n            $('#dropdownAnnoPrimary .js-text').text('Anno File');\n\n            clearPrimaryAnnotations();\n\n            // Close\n            $('#dropdownAnnoPrimary').click();\n\n            return false;\n\n        }\n\n        // Confirm to override.\n        if (currentAnnoName !== 'Anno File') {\n            if (!window.confirm('Are you sure to load another Primary Annotation ?')) {\n                return;\n            }\n        }\n\n        $('#dropdownAnnoPrimary .js-text').text(annoName);\n\n        $('#dropdownAnnoPrimary .fa-check').addClass('no-visible');\n        $this.find('.fa-check').removeClass('no-visible');\n\n        // Close\n        $('#dropdownAnnoPrimary').click();\n\n        // reload.\n        displayPrimaryAnnotation(annoName);\n\n        return false;\n    });\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/primaryAnnoDropdown/index.js\n// module id = 3\n// module chunks = 0","/**\n * UI parts - Reference Annotation Dropdown.\n */\n\n/**\n * Setup a click action of the Reference Annotation Dropdown.\n */\nexport function setup({\n    displayReferenceAnnotations\n}) {\n\n    $('#dropdownAnnoReference').on('click', 'a', e => {\n\n        let $this = $(e.currentTarget);\n\n        $this.find('.fa-check').toggleClass('no-visible');\n\n        let annoNames = [];\n        $('#dropdownAnnoReference a').each((index, element) => {\n            let $elm = $(element);\n            if ($elm.find('.fa-check').hasClass('no-visible') === false) {\n                annoNames.push($elm.find('.js-annoname').text());\n            }\n        });\n        if (annoNames.length > 0) {\n            $('#dropdownAnnoReference .js-text').text(annoNames.join(','));\n        } else {\n            $('#dropdownAnnoReference .js-text').text('Reference Files');\n        }\n\n        // Display reference annotations.\n        displayReferenceAnnotations(annoNames);\n\n        return false;\n\n    });\n\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/referenceAnnoDropdown/index.js\n// module id = 4\n// module chunks = 0","/**\n * UI parts - Anno List Dropdown.\n */\n\n/**\n * Setup the dropdown for Anno list.\n */\nexport function setup({\n        getAnnotations,\n        scrollToAnnotation\n    }) {\n\n    // Show the list of primary annotations.\n    $('#dropdownAnnoList').on('click', () => {\n\n        // Create html snipets.\n        let elements = getAnnotations().map(a => {\n\n            let icon;\n            if (a.type === 'span') {\n                icon = '<i class=\"fa fa-pencil\"></i>';\n            } else if (a.type === 'relation' && a.direction === 'one-way') {\n                icon = '<i class=\"fa fa-long-arrow-right\"></i>';\n            } else if (a.type === 'relation' && a.direction === 'two-way') {\n                icon = '<i class=\"fa fa-arrows-h\"></i>';\n            } else if (a.type === 'relation' && a.direction === 'link') {\n                icon = '<i class=\"fa fa-minus\"></i>';\n            } else if (a.type === 'area') {\n                icon = '<i class=\"fa fa-square-o\"></i>';\n            }\n\n            let snipet = `\n                <li>\n                    <a href=\"#\" data-id=\"${a.uuid}\">\n                        ${icon}&nbsp;&nbsp;<span>${a.text || ''}</span>\n                    </a>\n                </li>\n            `;\n\n            return snipet;\n        });\n\n        $('#dropdownAnnoList ul').html(elements);\n\n    });\n\n    // Jump to the page that the selected annotation is at.\n    $('#dropdownAnnoList').on('click', 'a', e => {\n\n        let id = $(e.currentTarget).data('id');\n\n        scrollToAnnotation(id);\n\n        // Close the dropdown.\n        $('#dropdownAnnoList').click();\n    });\n\n    // Update the number of display, at adding / updating/ deleting annotations.\n    function watchPrimaryAnno(e) {\n        $('#dropdownAnnoList .js-count').text(getAnnotations().length);\n    }\n    $(window)\n        .off('annotationrendered annotationUpdated', watchPrimaryAnno)\n        .on('annotationrendered annotationUpdated', watchPrimaryAnno);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/annoListDropdown/index.js\n// module id = 5\n// module chunks = 0","/**\n * UI parts - Download Button.\n */\n\n// TODO 機能としては必要だけど、どうしようか.\n// import { unlistenWindowLeaveEvent } from '../util/window';\n\n/**\n * Setup the behavior of a Download Button.\n */\nexport function setup({\n        getAnnotationTOMLString,\n        getCurrentContentName\n    }) {\n\n    $('#downloadButton').off('click').on('click', e => {\n\n        $(e.currentTarget).blur();\n\n        getAnnotationTOMLString().then(annotations => {\n            let blob = new Blob([annotations]);\n            let blobURL = window.URL.createObjectURL(blob);\n            let a = document.createElement('a');\n            document.body.appendChild(a); // for firefox working correctly.\n            a.download = _getDownloadFileName(getCurrentContentName);\n            a.href = blobURL;\n            a.click();\n            a.parentNode.removeChild(a);\n        });\n\n        // TODO 復活する.\n        // unlistenWindowLeaveEvent();\n\n        return false;\n    });\n\n}\n\n\n/**\n * Get the file name for download.\n */\nfunction _getDownloadFileName(getCurrentContentName) {\n\n    // The name of Primary Annotation.\n    let primaryAnnotationName;\n    $('#dropdownAnnoPrimary a').each((index, element) => {\n        let $elm = $(element);\n        if ($elm.find('.fa-check').hasClass('no-visible') === false) {\n            primaryAnnotationName = $elm.find('.js-annoname').text();\n        }\n    });\n    if (primaryAnnotationName) {\n        return primaryAnnotationName;\n    }\n\n    // The name of Content.\n    let pdfFileName = getCurrentContentName();\n    return pdfFileName.split('.')[0] + '.anno';\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/downloadButton/index.js\n// module id = 6\n// module chunks = 0","\n\nexport function setup({ enableRect, disableRect }) {\n\n    // Rect annotation button.\n    $('.js-tool-btn-rect').off('click').on('click', (e) => {\n\n        let $btn = $(e.currentTarget);\n\n        // Make disable.\n        if ($btn.hasClass('active')) {\n            window.currentAnnoToolType = 'view';\n            $btn.removeClass('active').blur();\n            disableRect();\n\n        // Make enable.\n        } else {\n            window.currentAnnoToolType = 'rect';\n            $btn.addClass('active');\n            enableRect();\n        }\n\n        return false;\n    });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/annoRectButton/index.js\n// module id = 7\n// module chunks = 0","\n\nexport function setup({ createRelAnnotation }) {\n\n    // Relation annotation button.\n    $('.js-tool-btn-rel').off('click').on('click', e => {\n        const $button = $(e.currentTarget);\n        const type = $button.data('type');\n        createRelAnnotation(type);\n        $button.blur();\n    });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/annoRelButton/index.js\n// module id = 8\n// module chunks = 0","\n\nexport function setup({ createSpanAnnotation }) {\n\n    $('.js-tool-btn-span').off('click').on('click', e => {\n\n        $(e.currentTarget).blur();\n\n        createSpanAnnotation();\n    });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/annoSpanButton/index.js\n// module id = 9\n// module chunks = 0","/**\n * UI parts - Input Label.\n */\n\n let $inputLabel;\n window.addEventListener('DOMContentLoaded', () => {\n    $inputLabel = $('#inputLabel');\n });\n\nlet _blurListener;\n\nlet currentUUID;\n\nlet _getSelectedAnnotations;\nlet _saveAnnotationText;\n\nexport function setup({ getSelectedAnnotations, saveAnnotationText }) {\n\n    _getSelectedAnnotations = getSelectedAnnotations;\n    _saveAnnotationText = saveAnnotationText;\n\n    // set datalist.\n    setDatalist();\n\n    // set actions.\n    setupActions();\n\n    // Start to listen window events.\n    listenWindowEvents();\n}\n\n\nexport function enable({ uuid, text, disable=false, autoFocus=false, blurListener=null }) {\n    console.log('enableInputLabel:', uuid, text);\n\n    currentUUID = uuid;\n\n    if (_blurListener) {\n        _blurListener();\n        _blurListener = null;\n        console.log('old _blurListener is called.');\n    }\n\n\n    $inputLabel\n        .attr('disabled', 'disabled')\n        .val(text || '')\n        .off('blur')\n        .off('keyup');\n\n    if (disable === false) {\n        $inputLabel\n            .removeAttr('disabled')\n            .on('keyup', () => {\n                saveText(uuid);\n            });\n    }\n\n    if (autoFocus) {\n        $inputLabel.focus();\n    }\n\n    $inputLabel.on('blur', () => {\n\n        if (blurListener) {\n            blurListener();\n            _blurListener = blurListener;\n        }\n\n        saveText(uuid);\n    });\n\n};\n\nexport function disable() {\n    console.log('disableInputLabel');\n\n    currentUUID = null;\n\n    $inputLabel\n        .attr('disabled', 'disabled')\n        .val('');\n}\n\nfunction treatAnnotationDeleted({ uuid }) {\n    console.log('treatAnnotationDeleted:', uuid);\n\n    if (currentUUID === uuid) {\n        disable(...arguments);\n    }\n}\n\nfunction handleAnnotationHoverIn(annotation) {\n    if (_getSelectedAnnotations().length === 0) {\n        enable({ uuid : annotation.uuid, text : annotation.text, disable : true });\n    }\n}\n\nfunction handleAnnotationHoverOut(annotation) {\n    if (_getSelectedAnnotations().length === 0) {\n        disable();\n    }\n}\n\nfunction handleAnnotationSelected(annotation) {\n    if (_getSelectedAnnotations().length === 1) {\n        enable({ uuid : annotation.uuid, text : annotation.text });\n    } else {\n        disable();\n    }\n}\n\nfunction handleAnnotationDeselected() {\n    const annos = _getSelectedAnnotations();\n    if (annos.length === 1) {\n        enable({ uuid : annos[0].uuid, text : annos[0].text });\n    } else {\n        disable();\n    }\n}\n\nfunction saveText(uuid) {\n\n    const text = $inputLabel.val() || '';\n\n    saveAnnotationText(uuid, text);\n}\n\n/**\n * Local storage key for datalist.\n */\nconst LSKEY_DATALIST = '_pdfanno_datalist';\n\nfunction setDatalist() {\n\n    // set datalist.\n    let datalist = JSON.parse(localStorage.getItem(LSKEY_DATALIST) || '[]');\n    const options = datalist.map(d => {\n        return `<option value=\"${d}\"></option>`;\n    });\n    $('#labels').html(options);\n}\n\nfunction setupActions() {\n    // Setup datalist modal.\n    $('#datalistModal').off().on('show.bs.modal', e => {\n\n        // datalist.\n        let datalist = JSON.parse(localStorage.getItem(LSKEY_DATALIST) || '[]');\n\n        // input for new.\n        datalist.push('');\n\n        const snipets = datalist.map(d => {\n            return `\n            <li class=\"list-group-item\">\n                <input class=\"form-control js-input\" value=\"${d}\">\n                <span class=\"glyphicon glyphicon-remove js-delete\"></span>\n            </li>\n            `;\n        });\n\n        $('#datalistModal .js-datalist').html(snipets.join(''));\n\n    });\n\n    $('#datalistModal').on('keyup', '.js-input', e => {\n\n        const $this = $(e.currentTarget);\n        const val = $this.val();\n        const isEnd = $this.parent().is(':last-child');\n\n        if (isEnd && val && val.length > 0) {\n            $('#datalistModal .js-datalist').append(`\n                <li class=\"list-group-item\">\n                    <input class=\"form-control js-input\" value=\"\">\n                    <span class=\"glyphicon glyphicon-remove js-delete\"></span>\n                </li>\n            `);\n        }\n    });\n\n    $('#datalistModal').on('click', '.js-delete', e => {\n        $(e.currentTarget).parent().remove();\n    });\n\n    $('#datalistModal .js-done').on('click', e => {\n\n        let datalist = [];\n        $('#datalistModal .js-datalist .js-input').each(function() {\n            const val = $(this).val();\n            if (val && val.length > 0) {\n                datalist.push(val);\n            }\n        });\n\n        localStorage.setItem(LSKEY_DATALIST, JSON.stringify(datalist));\n\n        setDatalist();\n\n        $('#datalistModal').modal('hide');\n    });\n}\n\n\nfunction listenWindowEvents() {\n\n    // enable text input.\n    window.addEventListener('enableTextInput', e => {\n        console.log('enableTextInput:', e.detail);\n        enable(e.detail);\n    });\n\n    // disable text input.\n    window.addEventListener('disappearTextInput', e => {\n        console.log('disappearTextInput:', e.detail);\n        disable(e.detail);\n    });\n\n    // handle annotation deleted.\n    window.addEventListener('annotationDeleted', e => {\n        treatAnnotationDeleted(e.detail);\n    });\n\n    // handle annotation hoverIn.\n    window.addEventListener('annotationHoverIn' , e => {\n        handleAnnotationHoverIn(e.detail);\n    });\n\n    // handle annotation hoverOut.\n    window.addEventListener('annotationHoverOut' , e => {\n        handleAnnotationHoverOut(e.detail);\n    });\n\n    // handle annotation selected.\n    window.addEventListener('annotationSelected' , e => {\n        handleAnnotationSelected(e.detail);\n    });\n\n    // handle annotation deselected.\n    window.addEventListener('annotationDeselected' , () => {\n        handleAnnotationDeselected();\n    });\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/labelInput/index.js\n// module id = 10\n// module chunks = 0"],"sourceRoot":""}